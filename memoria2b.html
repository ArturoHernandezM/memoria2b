<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<title>Memorama de sonidos e im√°genes</title>
<style>
  body {
    font-family: Arial, sans-serif;
    background-color: #002040;
    color: white;
    text-align: center;
    margin: 0;
    padding: 0;
    position: relative;
    overflow-x: hidden;
  }

  h1 { margin-top: 20px; }

  /* Barra superior */
  #top-bar {
    display: flex;
    justify-content: center;
    align-items: center;
    gap: 20px;
    flex-wrap: wrap;
    margin: 10px auto;
    font-size: 1.2em;
  }
  #stats { display: flex; gap: 15px; align-items: center; }

  #reset-btn {
  padding: 8px 18px;
  font-size: 1em;
  border: 2px solid rgba(255, 255, 255, 0.6);
  border-radius: 8px;
  background-color: #00bbff;
  color: white;
  cursor: pointer;
  position: relative;
  z-index: 10; /* üëà asegura que siempre quede por encima del overlay */
  box-shadow: 0 0 10px rgba(255, 255, 255, 0.4); /* resplandor sutil */
  transition: all 0.25s ease;
}

#reset-btn:hover {
  background-color: #0099dd;
  box-shadow: 0 0 14px rgba(255, 255, 255, 0.6);
}

  /* Cuadr√≠cula fija 4x4 (tarjetas 10% m√°s peque√±as ya aplicadas anteriormente) */
  #game-board {
    display: grid;
    grid-template-columns: repeat(4, 1fr);
    grid-template-rows: repeat(4, 1fr);
    gap: 16px;
    justify-content: center;
    max-width: 430px;
    margin: 30px auto;
    padding: 0 10px;
    position: relative;
    z-index: 1;
  }

  .card {
    aspect-ratio: 1 / 1;
    background-color: transparent;
    border-radius: 15px;
    display: flex;
    align-items: center;
    justify-content: center;
    cursor: pointer;
    transition: transform 0.4s, opacity 0.8s;
    position: relative;
    perspective: 1000px;
  }

  .card-inner {
    position: relative;
    width: 100%;
    height: 100%;
    transform-style: preserve-3d;
    transition: transform 0.6s;
  }
  .card.flipped .card-inner { transform: rotateY(180deg); }

  .card-front, .card-back {
    position: absolute;
    width: 100%;
    height: 100%;
    border-radius: 15px;
    backface-visibility: hidden;
    overflow: hidden;
  }

  /* Dorso liso */
  .card-front { background-color: #004080; }

  /* Reverso (cara visible al voltear) */
  .card-back {
    transform: rotateY(180deg);
    background-color: #00aa88;
    display: flex;
    align-items: center;
    justify-content: center;
  }

  .card-back img {
    width: 100%;
    height: 100%;
    object-fit: contain; /* conserva proporci√≥n sin recortar */
    border-radius: 15px;
  }

  .card.matched { opacity: 0; pointer-events: none; }

  #game-over { font-size: 1.5em; margin-top: 20px; }

  /* Responsivo */
  @media (max-width: 600px) {
    #game-board { max-width: 330px; gap: 12px; }
    #top-bar { flex-direction: column; gap: 8px; }
  }

  /* Animaci√≥n del mensaje: entrada suave (pop) */
  @keyframes popIn {
    0% { opacity: 0; transform: scale(0.7); }
    60% { opacity: 1; transform: scale(1.05); }
    100% { opacity: 1; transform: scale(1); }
  }

  /* Animaci√≥n de peque√±o 'shake' para el mensaje de error */
  @keyframes shakePop {
    0%   { opacity: 0; transform: scale(0.85) translateX(0); }
    60%  { opacity: 1; transform: scale(1.03) translateX(-6px); }
    75%  { transform: scale(1.02) translateX(6px); }
    90%  { transform: scale(1.01) translateX(-3px); }
    100% { transform: scale(1) translateX(0); }
  }

  .win-message { text-align:center; color:white; animation: popIn 0.8s ease-out; }
  .lose-message { text-align:center; color:white; animation: shakePop 0.9s ease-out; }

  /* overlay central con mensajes */
  .overlay-outer {
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    display: none;
    align-items: center;
    justify-content: center;
    backdrop-filter: blur(8px);
    background-color: rgba(0, 0, 0, 0.3);
    z-index: 5;
    pointer-events: none; /* ‚úÖ deja pasar clics al bot√≥n de reinicio */
  }

  @keyframes popIn {
    0% { opacity: 0; transform: scale(0.7); }
    60% { opacity: 1; transform: scale(1.05); }
    100% { opacity: 1; transform: scale(1); }
  }

  .win-message, .lose-message {
    text-align: center;
    color: white;
    animation: popIn 0.8s ease-out;
  }

  .small-text {
    font-size: 0.9em;
    color: #ddd;
  }

  @media (max-width: 600px) {
    #game-board {
      gap: 15px;
      max-width: 400px;
    }
  }

  .overlay-inner { pointer-events: all; } /* el contenido del mensaje s√≠ captura eventos si se quiere */
</style>
</head>
<body>

<h1>Memorama de sonidos e im√°genes üé∂üñºÔ∏è</h1>

<!-- Barra superior con tiempo/errores y reinicio alineados -->
<div id="top-bar">
  <div id="stats">
    ‚è±Ô∏è Tiempo: <span id="time">0</span> s |
    ‚ùå Errores: <span id="errors">0</span>/8
  </div>
  <button id="reset-btn">Reiniciar</button>
</div>

<div id="game-board"></div>
<div id="game-over"></div>

<!-- Overlays para victoria y derrota -->
<div id="win-overlay" class="overlay-outer" aria-hidden="true">
  <div class="overlay-inner win-message">
    <div style="font-size:2.3em; margin-bottom:10px;">üéâ ¬°Lo lograste!</div>
    <div style="font-size:0.9em; color:#ddd;">
      Material did√°ctico elaborado por el DTI. Arturo Hern√°ndez Maldonado.
    </div>
  </div>
</div>

<div id="lose-overlay" class="overlay-outer" aria-hidden="true">
  <div class="overlay-inner lose-message" style="color:#ffdede;">
    <div style="font-size:1.9em; margin-bottom:8px;">üíÄ Juego terminado.</div>
    <div style="font-size:1.0em; margin-bottom:6px;">Excediste 7 errores.</div>
  </div>
</div>

<script>
/* PARES: reemplaza rutas por tus archivos reales */
const pairs = [
  { id: 1, sound: "1.mp3", image: "1.jpg" },
  { id: 2, sound: "2.mp3", image: "2.jpg" },
  { id: 3, sound: "3.mp3", image: "3.jpg" },
  { id: 4, sound: "4.mp3", image: "4.jpg" },
  { id: 5, sound: "5.mp3", image: "5.jpg" },
  { id: 6, sound: "6.mp3", image: "6.jpg" },
  { id: 7, sound: "7.mp3", image: "7.jpg" },
  { id: 8, sound: "8.mp3", image: "8.jpg" },
];

let flippedCards = [];
let matchedCount = 0;
let errors = 0;
let timer = 0;
let timerInterval = null;
let timerStarted = false;
const maxErrors = 8; // ‚Üê l√≠mite actualizado

const board = document.getElementById("game-board");
const timeDisplay = document.getElementById("time");
const errorsDisplay = document.getElementById("errors");
const gameOverDisplay = document.getElementById("game-over");
const winOverlay = document.getElementById("win-overlay");
const loseOverlay = document.getElementById("lose-overlay");
const resetBtn = document.getElementById("reset-btn");

function shuffle(array) {
  for (let i = array.length - 1; i > 0; i--) {
    const j = Math.floor(Math.random() * (i + 1));
    [array[i], array[j]] = [array[j], array[i]];
  }
  return array;
}

function startGame() {
  board.innerHTML = "";
  hideOverlays();
  board.style.filter = "none";
  gameOverDisplay.textContent = "";
  flippedCards = [];
  matchedCount = 0;
  errors = 0;
  timer = 0;
  timerStarted = false;
  clearInterval(timerInterval);
  timeDisplay.textContent = "0";
  errorsDisplay.textContent = "0";

  // crear 16 tarjetas (8 sonidos + 8 im√°genes)
  const cards = [];
  pairs.forEach(p => {
    cards.push({ type: "sound", id: p.id, content: p.sound });
    cards.push({ type: "image", id: p.id, content: p.image });
  });

  const gameCards = shuffle(cards);

  gameCards.forEach(item => {
    const card = document.createElement("div");
    card.classList.add("card");
    card.dataset.id = item.id;
    card.dataset.type = item.type;

    const inner = document.createElement("div");
    inner.classList.add("card-inner");

    const front = document.createElement("div");
    front.classList.add("card-front");

    const back = document.createElement("div");
    back.classList.add("card-back");

    if (item.type === "image") {
      const img = document.createElement("img");
      img.src = item.content;
      img.alt = `Imagen ${item.id}`;
      back.appendChild(img);
    } else {
      // reverso liso para sonido (no icono)
      back.style.backgroundColor = "#00aa88";
    }

    inner.appendChild(front);
    inner.appendChild(back);
    card.appendChild(inner);

    card.addEventListener("click", () => flipCard(card, item));
    board.appendChild(card);
  });
}

function startTimer() {
  timerInterval = setInterval(() => {
    timer++;
    timeDisplay.textContent = timer;
  }, 1000);
}

function playSound(src) {
  const audio = new Audio(src);
  audio.currentTime = 0;
  audio.play();
}

function flipCard(card, item) {
  if (!timerStarted) {
    startTimer();
    timerStarted = true;
  }

  if (card.classList.contains("flipped") || card.classList.contains("matched") || flippedCards.length === 2) return;

  card.classList.add("flipped");
  if (item.type === "sound") playSound(item.content);
  flippedCards.push(card);

  if (flippedCards.length === 2) {
    const [first, second] = flippedCards;
    // empareja solo si mismo id y tipos distintos (sound vs image)
if (first.dataset.id === second.dataset.id && first.dataset.type !== second.dataset.type) {
  // üîä Reproduce sonido de acierto
  const successSound = new Audio("acierto.mp3"); // coloca tu archivo aqu√≠
  successSound.currentTime = 0;
  successSound.play();

  setTimeout(() => {
    first.classList.add("matched");
    second.classList.add("matched");
    flippedCards = [];
    matchedCount++;
    if (matchedCount === pairs.length) endGame(true);
  }, 600);
} else {
      errors++;
      errorsDisplay.textContent = errors;
      setTimeout(() => {
        first.classList.remove("flipped");
        second.classList.remove("flipped");
        flippedCards = [];
        if (errors >= maxErrors) endGame(false);
      }, 1000);
    }
  }
}

function hideOverlays() {
  winOverlay.style.display = "none";
  winOverlay.setAttribute("aria-hidden","true");
  loseOverlay.style.display = "none";
  loseOverlay.setAttribute("aria-hidden","true");
}

function endGame(won) {
  clearInterval(timerInterval);
  // bloquear interacciones en cartas
  document.querySelectorAll(".card").forEach(c => c.style.pointerEvents = "none");

  if (won) {
    // üîä Reproduce sonido de victoria
    const winSound = new Audio("victoria.mp3");
    winSound.currentTime = 0;
    winSound.play();

    board.style.filter = "blur(5px)";
    winOverlay.style.display = "flex";
    winOverlay.setAttribute("aria-hidden","false");
  } else {
    // üîä Reproduce sonido de error al perder
    const errorSound = new Audio("error.mp3"); // ‚Üê agrega tu archivo aqu√≠
    errorSound.currentTime = 0;
    errorSound.play();

    board.style.filter = "blur(5px)";
    loseOverlay.style.display = "flex";
    loseOverlay.setAttribute("aria-hidden","false");
  }
}

// Reiniciar activa inmediatamente aunque overlay est√© visible
resetBtn.addEventListener("click", startGame);

startGame();
</script>

</body>
</html>